{"version":3,"sources":["webpack:///./src/views/historyOrder/user/OrderTable.vue?82d7","webpack:///./src/api/user/order.js","webpack:///src/views/historyOrder/user/OrderTable.vue","webpack:///./src/views/historyOrder/user/OrderTable.vue?18f6","webpack:///./src/views/historyOrder/user/OrderTable.vue","webpack:///./src/api/user/package.js","webpack:///./src/views/historyOrder/user/OrderTable.vue?34eb"],"names":["render","_vm","this","_h","$createElement","_c","_self","directives","name","rawName","value","expression","style","device","padding","attrs","element-loading-text","$t","staticStyle","width","border","data","orderData","type","scopedSlots","_u","key","fn","props","staticClass","label-position","inline","_l","row","item","order_id","label","_v","_s","subject","amount","traffic","_e","align","prop","formatter","formatterType","formatterPayMethod","scope","size","trade_status","formatterStatus","fixed","on","click","$event","handlePay","ref","trigger","placement","text-align","margin","pClose","handleCloseOrder","slot","pShow","margin-top","layout","total","page-size","pageSize","current-page","currentPage","current-change","cueerntPageChange","staticRenderFns","fetchOrder","user_id","page","Object","request","url","concat","method","closeOrder","userID","orderID","OrderTablevue_type_script_lang_js_","tableLoading","payLoading","computed","objectSpread","vuex_esm","mounted","handleGetOrder","methods","id","$refs","doClose","doShow","order","_this","auth","then","res","$message","message","catch","err","console","log","language","details","payment","column","status","current","formatData","forEach","created_at","moment_default","format","_this2","orders","_this3","user_package","available","window","location","href","pay_url","$messageBox","confirm","confirmButtonText","showCancelButton","user_OrderTablevue_type_script_lang_js_","component","componentNormalizer","options","__file","__webpack_exports__","__webpack_require__","d","fetchPackage","fetchMonthlyPackage","createOrder","fetchPayUrl","checkAlipayOrder","checkPaypalOrder","checkIn","_utils_request__WEBPACK_IMPORTED_MODULE_0__","payMethod","param","paymentID","payerID","_node_modules_mini_css_extract_plugin_dist_loader_js_ref_6_oneOf_1_0_node_modules_css_loader_index_js_ref_6_oneOf_1_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_lib_index_js_ref_6_oneOf_1_2_node_modules_cache_loader_dist_cjs_js_ref_0_0_node_modules_vue_loader_lib_index_js_vue_loader_options_OrderTable_vue_vue_type_style_index_0_id_3f48e0b6_lang_css_scoped_true___WEBPACK_IMPORTED_MODULE_0__","_node_modules_mini_css_extract_plugin_dist_loader_js_ref_6_oneOf_1_0_node_modules_css_loader_index_js_ref_6_oneOf_1_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_lib_index_js_ref_6_oneOf_1_2_node_modules_cache_loader_dist_cjs_js_ref_0_0_node_modules_vue_loader_lib_index_js_vue_loader_options_OrderTable_vue_vue_type_style_index_0_id_3f48e0b6_lang_css_scoped_true___WEBPACK_IMPORTED_MODULE_0___default","n"],"mappings":"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","file":"js/chunk-98de.92d683d0.js","sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{directives:[{name:\"loading\",rawName:\"v-loading\",value:(_vm.payLoading),expression:\"payLoading\"}],style:(_vm.device === 'mobile' ? {} : {padding: '30px 120px'}),attrs:{\"element-loading-text\":_vm.$t('package.payLoadingTip')}},[_c('el-table',{directives:[{name:\"loading\",rawName:\"v-loading\",value:(_vm.tableLoading),expression:\"tableLoading\"}],staticStyle:{\"width\":\"100%\"},attrs:{\"border\":\"\",\"data\":_vm.orderData}},[_c('el-table-column',{attrs:{\"type\":\"expand\"},scopedSlots:_vm._u([{key:\"default\",fn:function(props){return [_c('el-form',{staticClass:\"table-expand\",attrs:{\"label-position\":\"left\",\"inline\":\"\"}},[_vm._l((props.row.details),function(item){return [(item.amount)?[_c('el-form-item',{key:item.order_id,attrs:{\"label\":_vm.$t('order.packageName')}},[_c('span',[_vm._v(_vm._s(item.subject))])]),_c('el-form-item',{key:item.order_id,attrs:{\"label\":_vm.$t('order.amount')}},[_c('span',[_vm._v(_vm._s(item.amount))])]),_c('el-form-item',{key:item.order_id,attrs:{\"label\":_vm.$t('order.totalTraffic')}},[_c('span',[_vm._v(_vm._s(item.traffic*item.amount)+\" TB\")])])]:_vm._e()]})],2)]}}])}),_c('el-table-column',{attrs:{\"align\":\"center\",\"prop\":\"created_at\",\"label\":_vm.$t('order.createTime')}}),_c('el-table-column',{attrs:{\"align\":\"center\",\"prop\":\"type\",\"label\":_vm.$t('order.type'),\"formatter\":_vm.formatterType}}),_c('el-table-column',{attrs:{\"align\":\"center\",\"prop\":\"payment\",\"label\":_vm.$t('order.payMethod'),\"formatter\":_vm.formatterPayMethod}}),_c('el-table-column',{attrs:{\"align\":\"center\",\"prop\":\"price\",\"label\":_vm.$t('order.price')}}),_c('el-table-column',{attrs:{\"align\":\"center\",\"prop\":\"currency\",\"label\":_vm.$t('order.currency')}}),_c('el-table-column',{attrs:{\"align\":\"center\",\"label\":_vm.$t('order.status')},scopedSlots:_vm._u([{key:\"default\",fn:function(scope){return [_c('el-tag',{attrs:{\"size\":\"medium\",\"type\":scope.row.trade_status==='WAIT_BUYER_PAY'?'':scope.row.trade_status==='TRADE_CLOSED'?'danger':'success'}},[_vm._v(_vm._s(_vm.formatterStatus(scope.row)))])]}}])}),_c('el-table-column',{attrs:{\"fixed\":\"right\",\"align\":\"center\",\"label\":_vm.$t('order.action')},scopedSlots:_vm._u([{key:\"default\",fn:function(scope){return [(scope.row.trade_status === 'WAIT_BUYER_PAY')?_c('el-button',{attrs:{\"type\":\"primary\",\"size\":\"mini\"},on:{\"click\":function($event){_vm.handlePay(scope.row)}}},[_vm._v(_vm._s(_vm.$t('order.pay')))]):_vm._e(),_c('el-popover',{ref:'popover-' + scope.row.order_id,style:(_vm.device==='mobile'?'':'margin-left: 10px'),attrs:{\"trigger\":\"manual\",\"placement\":\"top\",\"width\":\"160\"}},[_c('p',[_vm._v(_vm._s(_vm.$t('order.tip')))]),_c('div',{staticStyle:{\"text-align\":\"right\",\"margin\":\"0\"}},[_c('el-button',{attrs:{\"size\":\"mini\",\"type\":\"text\"},on:{\"click\":function($event){_vm.pClose(scope.row.order_id)}}},[_vm._v(_vm._s(_vm.$t('common.cancel')))]),_c('el-button',{attrs:{\"type\":\"primary\",\"size\":\"mini\"},on:{\"click\":function($event){_vm.handleCloseOrder(scope.row)}}},[_vm._v(_vm._s(_vm.$t('common.ok')))])],1),(scope.row.trade_status === 'WAIT_BUYER_PAY')?[_c('el-button',{attrs:{\"slot\":\"reference\",\"type\":\"danger\",\"size\":\"mini\"},on:{\"click\":function($event){_vm.pShow(scope.row.order_id)}},slot:\"reference\"},[_vm._v(_vm._s(_vm.$t('order.close')))])]:_vm._e()],2)]}}])})],1),_c('el-pagination',{staticStyle:{\"margin-top\":\"20px\"},attrs:{\"layout\":\"prev, pager, next\",\"total\":_vm.total,\"page-size\":_vm.pageSize,\"current-page\":_vm.currentPage},on:{\"current-change\":_vm.cueerntPageChange}})],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","import request from '@/utils/request'\n\n// 用户获取自己的订单\nexport function fetchOrder(user_id, page, pageSize) {\n  return request({\n    url: `order/user_id/${user_id}?page=${page}&page_size=${pageSize}`,\n    method: 'get',\n  })\n}\n\n// 用户关闭自己的订单\nexport function closeOrder(userID, orderID) {\n  return request({\n    url: `order/user_id/${userID}?order_id=${orderID}`,\n    method: 'delete'\n  })\n}\n","<template>\n  <div :style=\"device === 'mobile' ? {} : {padding: '30px 120px'}\" v-loading=\"payLoading\" :element-loading-text=\"$t('package.payLoadingTip')\">\n    <el-table border :data=\"orderData\" v-loading=\"tableLoading\" style=\"width: 100%\">\n    <el-table-column type=\"expand\">\n      <template slot-scope=\"props\">\n        <el-form label-position=\"left\" inline class=\"table-expand\">\n          <template v-for=\"item in props.row.details\">\n            <template v-if=\"item.amount\">\n              <el-form-item :label=\"$t('order.packageName')\" :key=\"item.order_id\">\n                <span>{{ item.subject }}</span>\n              </el-form-item>\n              <el-form-item :label=\"$t('order.amount')\" :key=\"item.order_id\">\n                <span>{{ item.amount }}</span>\n              </el-form-item>\n              <el-form-item :label=\"$t('order.totalTraffic')\" :key=\"item.order_id\">\n                <span>{{ item.traffic*item.amount }} TB</span>\n              </el-form-item>\n            </template>\n          </template>\n        </el-form>\n      </template>\n    </el-table-column>\n\n      <el-table-column align=\"center\" prop=\"created_at\" :label=\"$t('order.createTime')\"></el-table-column>\n      <el-table-column align=\"center\" prop=\"type\" :label=\"$t('order.type')\" :formatter=\"formatterType\"></el-table-column>\n      <el-table-column align=\"center\" prop=\"payment\" :label=\"$t('order.payMethod')\" :formatter=\"formatterPayMethod\"></el-table-column>\n      <el-table-column align=\"center\" prop=\"price\" :label=\"$t('order.price')\"></el-table-column>\n      <el-table-column align=\"center\" prop=\"currency\" :label=\"$t('order.currency')\"></el-table-column>\n\n      <el-table-column align=\"center\"  :label=\"$t('order.status')\">\n        <template slot-scope=\"scope\" :formatter=\"formatterStatus\">\n          <el-tag size=\"medium\" :type=\"scope.row.trade_status==='WAIT_BUYER_PAY'?'':scope.row.trade_status==='TRADE_CLOSED'?'danger':'success'\">{{ formatterStatus(scope.row) }}</el-tag>\n        </template>\n      </el-table-column>\n\n      <el-table-column fixed=\"right\" align=\"center\" :label=\"$t('order.action')\">\n        <template slot-scope=\"scope\">\n          <el-button v-if=\"scope.row.trade_status === 'WAIT_BUYER_PAY'\" type=\"primary\" size=\"mini\" @click=\"handlePay(scope.row)\">{{ $t('order.pay') }}</el-button>\n          <el-popover\n            :style=\"device==='mobile'?'':'margin-left: 10px'\"\n            trigger=\"manual\"\n            placement=\"top\"\n            width=\"160\"\n            :ref=\"'popover-' + scope.row.order_id\">\n            <p>{{ $t('order.tip') }}</p>\n            <div style=\"text-align: right; margin: 0\">\n              <el-button size=\"mini\" type=\"text\" @click=\"pClose(scope.row.order_id)\">{{ $t('common.cancel') }}</el-button>\n              <el-button type=\"primary\" size=\"mini\" @click=\"handleCloseOrder(scope.row)\">{{ $t('common.ok') }}</el-button>\n            </div>\n            <template v-if=\"scope.row.trade_status === 'WAIT_BUYER_PAY'\">\n              <el-button slot=\"reference\" type=\"danger\" size=\"mini\" @click=\"pShow(scope.row.order_id)\">{{ $t('order.close') }}</el-button>\n            </template>\n          </el-popover>\n        </template>\n      </el-table-column>\n    </el-table>\n    <el-pagination style=\"margin-top: 20px\" layout=\"prev, pager, next\" :total=\"total\" :page-size=\"pageSize\" :current-page=\"currentPage\" @current-change=\"cueerntPageChange\"></el-pagination>\n  </div>\n</template>\n\n<script>\nimport { fetchOrder, closeOrder } from '@/api/user/order'\nimport { fetchPayUrl } from '@/api/user/package'\nimport { getID } from '@/utils/auth'\nimport { mapGetters } from 'vuex'\nimport moment from 'moment'\n\nexport default {\n  name: 'OrderTable',\n  data() {\n    return {\n      tableLoading: false,\n      payLoading: false,\n\n      orderData: [],\n      total: 0,\n      pageSize: 10,\n      currentPage: 1\n    }\n  },\n  computed: {\n    ...mapGetters([\n      'device',\n      'language'\n    ])\n  },\n  mounted() {\n    this.handleGetOrder()\n  },\n  methods: {\n    pClose(id) {\n      this.$refs[`popover-` + id].doClose()\n    },\n    pShow(id) {\n      this.$refs[`popover-` + id].doShow()\n    },\n    handleCloseOrder(order) {\n      closeOrder(getID(), order.order_id)\n        .then(res => {\n          this.$message({\n            message: this.$t('common.closeSuccess'),\n            type: 'success'\n          })\n          this.handleGetOrder()\n          this.pClose(order.order_id)\n        })\n        .catch(err => {\n          this.pClose(order.order_id)\n          console.log(err)\n        })\n    },\n    formatterType(row) {\n      let type = ''\n      if(row.type === 'flow_packet_cn' || row.type === 'flow_packet_en'){\n        type = this.$t('order.flowPackage')\n      } else {\n        type = this.language === 'en' ? row.details[0].subject : row.details[0].subject\n      }\n      return type\n    },\n    formatterPayMethod(row) {\n      return (row.payment === 'alipay') ? this.$t('order.alipay') : row.payment\n    },\n    formatterStatus(row, column) {\n      let status = ''\n      switch (row.trade_status) {\n        case 'WAIT_BUYER_PAY':\n          status = this.$t('order.waitPay')\n          break;\n        case 'TRADE_SUCCESS':\n          status = this.$t('order.finish')\n          break;\n        case 'TRADE_FINISHED':\n          status = this.$t('order.finish')\n          break;\n        case 'TRADE_CLOSED':\n          status = this.$t('order.fail')\n          break;\n        default:\n          break;\n        }\n        return status\n    },\n    cueerntPageChange(current) {\n      this.currentPage = current\n      this.handleGetOrder()\n    },\n    formatData(data) {\n      data.forEach(item => {\n        item.created_at = moment(item.created_at).format('YYYY-MM-DD HH:mm:ss')\n      })\n      return data\n    },\n    handleGetOrder() {\n      this.tableLoading = true\n      fetchOrder(getID(), this.currentPage, this.pageSize)\n        .then(res => {\n          this.tableLoading = false\n          if(res.data) {\n            this.orderData = this.formatData(res.data.orders)\n            this.total = res.data.total\n          }\n        })\n        .catch(err => {\n          this.tableLoading = false\n          this.orderData = []\n          this.total = 0\n          console.log(err)\n        })\n    },\n    handlePay(order) {\n      this.payLoading = true\n      fetchPayUrl(order.payment, order.order_id, this.device)\n        .then(res => {\n          if(res.data.available) {\n            window.location.href = `${res.data.pay_url}`\n          } else {\n            this.$messageBox.confirm(this.$t('package.systemError'), {\n              type: 'error',\n              confirmButtonText: this.$t('common.ok'),\n              showCancelButton: false\n            })\n          }\n        })\n        .catch(err => {\n          this.payLoading = false\n          console.log(err)\n        })\n    }\n  }\n}\n</script>\n\n<style lang=\"css\" scoped>\n  .table-expand {\n    font-size: 0;\n  }\n  .table-expand label {\n    width: 90px;\n    color: #99a9bf;\n  }\n  .table-expand .el-form-item {\n    text-align: center;\n    margin-right: 0;\n    margin-bottom: 0;\n    width: 33%;\n  }\n</style>\n","import mod from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./OrderTable.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./OrderTable.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./OrderTable.vue?vue&type=template&id=3f48e0b6&scoped=true&\"\nimport script from \"./OrderTable.vue?vue&type=script&lang=js&\"\nexport * from \"./OrderTable.vue?vue&type=script&lang=js&\"\nimport style0 from \"./OrderTable.vue?vue&type=style&index=0&id=3f48e0b6&lang=css&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"3f48e0b6\",\n  null\n  \n)\n\ncomponent.options.__file = \"OrderTable.vue\"\nexport default component.exports","import request from '@/utils/request'\n\n// 获取套餐信息\nexport function fetchPackage() {\n  return request({\n    url: `goods/flow_packet`,\n    method: 'get'\n  })\n}\n\n// 获取包年包月套餐信息\nexport function fetchMonthlyPackage() {\n  return request({\n    url: `goods/monthly_packet`,\n    method: 'get'\n  })\n}\n\n// 用户创建订单\nexport function createOrder(userID, data) {\n  return request({\n    url: `order/user_id/${userID}`,\n    method: 'post',\n    data\n  })\n}\n\n// 获取支付地址\nexport function fetchPayUrl(payMethod, orderID, device) {\n  const param = device === 'mobile' ? '&mobile=true' : ''\n  return request({\n    url: `charge/${payMethod}/pay?order_id=${orderID}${param}`,\n    method: 'get'\n  })\n}\n\n// 检查支付宝支付状态\nexport function checkAlipayOrder(orderID) {\n  return request({\n    url: `charge/alipay/query?order_id=${orderID}`,\n    method: 'get'\n  })\n}\n\n// 检查paypal支付状态\nexport function checkPaypalOrder(orderID, paymentID, payerID) {\n  return request({\n    url: `charge/paypal/query?order_id=${orderID}&payment_id=${paymentID}&payer_id=${payerID}`,\n    method: 'get'\n  })\n}\n\n// 用户签到\nexport function checkIn(userID, data) {\n  return request({\n    url: `user/user_id/${userID}/checkin`,\n    method: 'post',\n    data\n  })\n}","import mod from \"-!../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../../node_modules/css-loader/index.js??ref--6-oneOf-1-1!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/postcss-loader/lib/index.js??ref--6-oneOf-1-2!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./OrderTable.vue?vue&type=style&index=0&id=3f48e0b6&lang=css&scoped=true&\"; export default mod; export * from \"-!../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../../node_modules/css-loader/index.js??ref--6-oneOf-1-1!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/postcss-loader/lib/index.js??ref--6-oneOf-1-2!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./OrderTable.vue?vue&type=style&index=0&id=3f48e0b6&lang=css&scoped=true&\""],"sourceRoot":""}