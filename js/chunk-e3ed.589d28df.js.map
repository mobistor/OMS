{"version":3,"sources":["webpack:///./src/views/p2pConfig/user/activationRatio.vue?e908","webpack:///src/views/p2pConfig/user/activationRatio.vue","webpack:///./src/views/p2pConfig/user/activationRatio.vue?fc97","webpack:///./src/views/p2pConfig/user/activationRatio.vue","webpack:///./src/api/userDomain.js","webpack:///./src/api/user/p2pConfig.js"],"names":["render","_vm","this","_h","$createElement","_c","_self","style","device","staticStyle","margin-bottom","attrs","title","$t","directives","name","rawName","value","expression","border","data","tableData","align","prop","label","formatter","formatterStatus","scopedSlots","_u","key","fn","scope","min","max","show-input","model","row","callback","$$v","$set","blocked","reviewing","_v","_s","loading","type","nativeOn","click","$event","preventDefault","handleSubmit","staticClass","layout","page-sizes","page-size","tableParam","pageSize","current-page","page","on","size-change","handleSizeChange","current-change","handleCurrentChange","staticRenderFns","activationRatiovue_type_script_lang_js_","computed","Object","objectSpread","vuex_esm","mounted","fetchTableData","methods","_this","arguments","length","undefined","userDomain","isvalid","then","res","catch","err","console","log","handleP2PConfig","uid","id","_this2","p2pConfig","succeed","$message","message","error","domain","ratio","user_activationRatiovue_type_script_lang_js_","component","componentNormalizer","options","__file","__webpack_exports__","fetchHostNum","_utils_request__WEBPACK_IMPORTED_MODULE_5__","url","Date","getTime","toFixed","method","fetchDomain","order","filters","concat","forEach","item","fetchDomainUnderReview","blockDomain","whiteDomain","reviewDomain","searchHost","host","fetchUserList","fetchUserDomain","queryMap","_utils_auth__WEBPACK_IMPORTED_MODULE_6__","query","bindDomain","checkDomain","domainID","deleteDomain","fetchAdminUser","__webpack_require__","d","p2pConfigWifiOnly","p2pConfigRatio","_utils_request__WEBPACK_IMPORTED_MODULE_0__","user_id","domain_id"],"mappings":"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","file":"js/chunk-e3ed.589d28df.js","sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{style:(_vm.device === 'mobile' ? '' : 'padding: 30px 120px')},[_c('el-alert',{staticStyle:{\"margin-bottom\":\"20px\"},attrs:{\"title\":_vm.$t('p2pConfig.activationRatio.desc')}}),_c('el-table',{directives:[{name:\"loading\",rawName:\"v-loading\",value:(_vm.loading),expression:\"loading\"}],attrs:{\"border\":\"\",\"data\":_vm.tableData}},[_c('el-table-column',{attrs:{\"align\":\"center\",\"prop\":\"domain\",\"label\":_vm.$t('p2pConfig.name')}}),_c('el-table-column',{attrs:{\"align\":\"center\",\"formatter\":_vm.formatterStatus,\"label\":_vm.$t('p2pConfig.activationRatio.status')},scopedSlots:_vm._u([{key:\"default\",fn:function(scope){return [_c('el-slider',{attrs:{\"min\":0,\"max\":100,\"show-input\":\"\"},model:{value:(scope.row.ratio),callback:function ($$v) {_vm.$set(scope.row, \"ratio\", $$v)},expression:\"scope.row.ratio\"}})]}}])}),_c('el-table-column',{attrs:{\"label\":_vm.$t('domainTable.operation'),\"align\":\"center\"},scopedSlots:_vm._u([{key:\"default\",fn:function(scope){return [(!scope.row.blocked && !scope.row.reviewing)?_c('el-button',{attrs:{\"loading\":_vm.loading,\"type\":\"primary\"},nativeOn:{\"click\":function($event){$event.preventDefault();_vm.handleSubmit(scope.row)}}},[_vm._v(_vm._s(_vm.$t('common.ok')))]):_c('span',{style:('color: red')},[_vm._v(\"\\n                    \"+_vm._s(_vm.formatterStatus(scope.row))+\"\\n                 \")])]}}])})],1),_c('div',{staticClass:\"pagination-container\"},[_c('el-pagination',{attrs:{\"layout\":\"sizes, prev, pager, next\",\"page-sizes\":[10, 20, 50, 100],\"page-size\":_vm.tableParam.pageSize,\"current-page\":_vm.tableParam.page},on:{\"size-change\":_vm.handleSizeChange,\"current-change\":_vm.handleCurrentChange}})],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n    <div :style=\"device === 'mobile' ? '' : 'padding: 30px 120px'\">\n        <el-alert :title=\"$t('p2pConfig.activationRatio.desc')\" style=\"margin-bottom: 20px\"/>\n        <el-table border :data=\"tableData\" v-loading=\"loading\">\n            <el-table-column align=\"center\" prop=\"domain\" :label=\"$t('p2pConfig.name')\"></el-table-column>\n            <el-table-column align=\"center\" :formatter=\"formatterStatus\"\n                             :label=\"$t('p2pConfig.activationRatio.status')\">\n                <template slot-scope=\"scope\">\n            <el-slider v-model=\"scope.row.ratio\" :min=\"0\" :max=\"100\" show-input></el-slider>\n                </template>\n            </el-table-column>\n            <el-table-column :label=\"$t('domainTable.operation')\" align=\"center\">\n                <template slot-scope=\"scope\">\n                    <el-button v-if=\"!scope.row.blocked && !scope.row.reviewing\" :loading=\"loading\" type=\"primary\" @click.native.prevent=\"handleSubmit(scope.row)\">{{$t('common.ok')}}</el-button>\n                    <span v-else :style=\"'color: red'\">\n                        {{ formatterStatus(scope.row) }}\n                     </span>\n                </template>\n            </el-table-column>\n        </el-table>\n\n        <div class=\"pagination-container\">\n            <el-pagination\n                    layout=\"sizes, prev, pager, next\"\n                    :page-sizes=\"[10, 20, 50, 100]\"\n                    :page-size=\"tableParam.pageSize\"\n                    :current-page=\"tableParam.page\"\n                    @size-change=\"handleSizeChange\"\n                    @current-change=\"handleCurrentChange\">\n            </el-pagination>\n        </div>\n\n    </div>\n</template>\n\n<script>\n    import {fetchUserDomain} from '@/api/userDomain'\n    import {p2pConfigRatio} from '@/api/user/p2pConfig'\n    import {mapGetters} from 'vuex'\n\n    export default {\n        name: 'activationRatio',\n        data() {\n            return {\n                loading: false,\n                tableData: [],\n                tableParam: {\n                    page: 1,\n                    pageSize: 10\n                },\n            }\n        },\n        computed: {\n            ...mapGetters([\n                'device'\n            ])\n        },\n        mounted() {\n            this.fetchTableData()\n        },\n        methods: {\n            formatterStatus(row) {\n                if (row.blocked) {\n                    return this.$t('common.illegal')\n                }\n                if (row.reviewing) {\n                    return this.$t('common.reviewing')\n                }\n                return \"\"\n            },\n            fetchTableData(page = this.tableParam.page, pageSize = this.tableParam.pageSize) {\n                this.loading = true\n                fetchUserDomain(page, pageSize, {isvalid: true}).then(res => {\n                    if (res.data) {\n                        this.tableData = res.data\n                    }\n                    this.loading = false\n                }).catch(err => {\n                    this.loading = false\n                    console.log(err)\n                })\n            },\n            handleP2PConfig(uid, id, data) {\n                this.loading = true\n                p2pConfigRatio(uid, id, data)\n                    .then(res => {\n                        if (res.data.succeed) {\n                            this.$message({\n                                message: this.$t('p2pConfig.configSuccess'),\n                                type: 'success'\n                            })\n                        } else {\n                            this.$message.error(this.$t('p2pConfig.configFail'))\n                        }\n                        this.loading = false\n                    })\n                    .catch(err => {\n                        this.loading = false\n                        console.log(err)\n                    })\n            },\n            handleSubmit(domain) {\n                const data = {ratio: domain.ratio}\n                this.handleP2PConfig(domain.uid, domain.id, data)\n            },\n            handleSizeChange(pageSize) {\n                this.tableParam.pageSize = pageSize\n                this.fetchTableData()\n            },\n            handleCurrentChange(page) {\n                this.tableParam.page = page\n                this.fetchTableData()\n            },\n        },\n    }\n</script>\n","import mod from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./activationRatio.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./activationRatio.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./activationRatio.vue?vue&type=template&id=7a04495c&\"\nimport script from \"./activationRatio.vue?vue&type=script&lang=js&\"\nexport * from \"./activationRatio.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\ncomponent.options.__file = \"activationRatio.vue\"\nexport default component.exports","import request from '@/utils/request'\nimport { getID } from '@/utils/auth'\n\n// 获取活跃域名总数\nexport function fetchHostNum() {\n  return request({\n    url: `host/num?ts=${((new Date().getTime()) / 1000).toFixed() - 1800}`,\n    method: 'get'\n  })\n}\n\n// 获取域名列表\nexport function fetchDomain(page, pageSize, order, filters) {\n  let url = `host?page=${page}&page_size=${pageSize}&order=${order}`\n  filters.forEach(item => {\n    if(item.value)\n      url += `&${item.name}=${item.value}`\n  })\n  return request({\n    url,\n    method: 'get'\n  })\n}\n\n// 获取正在审核域名列表\nexport function fetchDomainUnderReview(page, pageSize) {\n    let url = `host/review?page=${page}&page_size=${pageSize}`\n    return request({\n        url,\n        method: 'get'\n    })\n}\n\n// 将域名拉黑或从黑名单移除\nexport function blockDomain(data) {\n  return request({\n    url: `/host/block`,\n    method: 'post',\n    data\n  })\n}\n\n// 将域名加入或从白名单移除\nexport function whiteDomain(data) {\n  return request({\n    url: `/host/whitelist`,\n    method: 'post',\n    data\n  })\n}\n\n// 将域名加入或从白名单移除\nexport function reviewDomain(data) {\n    return request({\n        url: `/host/review`,\n        method: 'post',\n        data\n    })\n}\n\n// 查找域名\nexport function searchHost(host) {\n  return request({\n    url: `host/search?keywords=${host}`,\n    method: 'get'\n  })\n}\n\n// 获取用户列表\nexport function fetchUserList(page, pageSize, order) {\n  return request({\n    url: `user?page=${page}&page_size=${pageSize}&order=${order}`,\n    method: 'get'\n  })\n}\n\n// 获取某用户的域名列表\nexport function fetchUserDomain(page, pageSize, queryMap) {\n  let url = `user/user_id/${getID()}/domain?page=${page}&page_size=${pageSize}`;\n\n  for (let query in queryMap) {\n      if (queryMap[query]) {\n          url = `${url}&${query}=1`\n      }\n  }\n  return request({\n    url,\n    method: 'get'\n  })\n}\n\n// 绑定域名\nexport function bindDomain(data) {\n  return request({\n    url: `user/user_id/${getID()}/domain`,\n    method: 'post',\n    data\n  })\n}\n\n// 认证域名\nexport function checkDomain(domainID) {\n  return request({\n    url: `user/user_id/${getID()}/domain/domain_id/${domainID}`,\n    method: 'post'\n  })\n}\n\n// 用户删除域名\nexport function deleteDomain(domainID) {\n  return request({\n    url: `user/user_id/${getID()}/domain/domain_id/${domainID}`,\n    method: 'delete'\n  })\n}\n\n// 管理员权限用户列表\nexport function fetchAdminUser() {\n  return request({\n    url: `user/admin`,\n    method: 'get'\n  })\n}","import request from '@/utils/request'\n\n// 用户配置网站p2p开关\nexport function p2pConfig(user_id, domain_id, data) {\n  return request({\n    url: `user/user_id/${user_id}/domain/domain_id/${domain_id}/control`,\n    method: 'post',\n    data\n  })\n}\n\n// 配置wifi only\nexport function p2pConfigWifiOnly(user_id, domain_id, data) {\n    return request({\n        url: `user/user_id/${user_id}/domain/domain_id/${domain_id}/control/wifi_only`,\n        method: 'post',\n        data\n    })\n}\n\n// 配置p2p激活比率\nexport function p2pConfigRatio(user_id, domain_id, data) {\n    return request({\n        url: `user/user_id/${user_id}/domain/domain_id/${domain_id}/control/ratio`,\n        method: 'post',\n        data\n    })\n}\n"],"sourceRoot":""}