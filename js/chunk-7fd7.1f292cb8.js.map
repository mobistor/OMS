{"version":3,"sources":["webpack:///./src/views/package/OrderDetail.vue?4feb","webpack:///./src/views/package/OrderDetail.vue?3fe1","webpack:///src/views/package/OrderDetail.vue","webpack:///./src/views/package/OrderDetail.vue?6b5e","webpack:///./src/views/package/OrderDetail.vue","webpack:///./src/api/user/package.js"],"names":["_node_modules_mini_css_extract_plugin_dist_loader_js_ref_8_oneOf_1_0_node_modules_css_loader_index_js_ref_8_oneOf_1_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_lib_index_js_ref_8_oneOf_1_2_node_modules_sass_loader_lib_loader_js_ref_8_oneOf_1_3_node_modules_cache_loader_dist_cjs_js_ref_0_0_node_modules_vue_loader_lib_index_js_vue_loader_options_OrderDetail_vue_vue_type_style_index_0_id_a31505ce_lang_scss_scoped_true___WEBPACK_IMPORTED_MODULE_0__","__webpack_require__","_node_modules_mini_css_extract_plugin_dist_loader_js_ref_8_oneOf_1_0_node_modules_css_loader_index_js_ref_8_oneOf_1_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_lib_index_js_ref_8_oneOf_1_2_node_modules_sass_loader_lib_loader_js_ref_8_oneOf_1_3_node_modules_cache_loader_dist_cjs_js_ref_0_0_node_modules_vue_loader_lib_index_js_vue_loader_options_OrderDetail_vue_vue_type_style_index_0_id_a31505ce_lang_scss_scoped_true___WEBPACK_IMPORTED_MODULE_0___default","n","render","_vm","this","_h","$createElement","_c","_self","directives","name","rawName","value","expression","style","device","padding","attrs","element-loading-text","$t","data","tableData","border","align","prop","label","staticClass","shadow","_v","_s","payMethod","totalPrice","type","on","click","payClick","visible","cantBuyVisible","width","update:visible","$event","slot","staticRenderFns","OrderDetailvue_type_script_lang_js_","payLoading","orderID","computed","Object","objectSpread","vuex_esm","mounted","$route","query","formatData","$router","push","methods","toConsumableArray","JSON","parse","buyData","console","log","forEach","item","total","amount","price","toFixed","handleFetchPayUrl","_this","user_package","then","res","available","window","location","href","concat","pay_url","catch","err","package_OrderDetailvue_type_script_lang_js_","component","componentNormalizer","options","__file","__webpack_exports__","d","fetchPackage","fetchMonthlyPackage","createOrder","fetchPayUrl","checkAlipayOrder","checkPaypalOrder","checkIn","_utils_request__WEBPACK_IMPORTED_MODULE_0__","url","method","userID","param","paymentID","payerID"],"mappings":"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","file":"js/chunk-7fd7.1f292cb8.js","sourcesContent":["import mod from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/css-loader/index.js??ref--8-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/lib/index.js??ref--8-oneOf-1-2!../../../node_modules/sass-loader/lib/loader.js??ref--8-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./OrderDetail.vue?vue&type=style&index=0&id=a31505ce&lang=scss&scoped=true&\"; export default mod; export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../node_modules/css-loader/index.js??ref--8-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/lib/index.js??ref--8-oneOf-1-2!../../../node_modules/sass-loader/lib/loader.js??ref--8-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./OrderDetail.vue?vue&type=style&index=0&id=a31505ce&lang=scss&scoped=true&\"","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{directives:[{name:\"loading\",rawName:\"v-loading\",value:(_vm.payLoading),expression:\"payLoading\"}],style:(_vm.device === 'mobile' ? {} : {padding: '30px 120px'}),attrs:{\"element-loading-text\":_vm.$t('package.payLoadingTip')}},[_c('el-table',{attrs:{\"data\":_vm.tableData,\"border\":\"\"}},[_c('el-table-column',{attrs:{\"align\":\"left\",\"prop\":\"subject\",\"label\":_vm.$t('package.packageInfo')}}),_c('el-table-column',{attrs:{\"align\":\"left\",\"prop\":\"price\",\"label\":_vm.$t('package.unitPrice')}}),_c('el-table-column',{attrs:{\"align\":\"left\",\"prop\":\"amount\",\"label\":_vm.$t('package.quantity')}}),_c('el-table-column',{attrs:{\"align\":\"left\",\"prop\":\"total\",\"label\":_vm.$t('package.expense')}})],1),_c('div',{staticClass:\"pay-submit\"},[_c('el-card',{attrs:{\"shadow\":\"never\"}},[_c('div',[_c('div',{staticClass:\"cost\"},[_c('span',[_vm._v(_vm._s(_vm.$t('package.total')))]),_c('span',{staticClass:\"price\"},[_c('span',[_vm._v(_vm._s(_vm.payMethod === 'alipay' ? '￥' : '$'))]),_c('em',[_vm._v(_vm._s(_vm.totalPrice))])])]),_c('el-button',{attrs:{\"type\":\"warning\"},on:{\"click\":_vm.payClick}},[_vm._v(_vm._s(_vm.$t('package.confirmPurchase')))])],1)])],1),_c('el-dialog',{attrs:{\"visible\":_vm.cantBuyVisible,\"width\":_vm.device === 'mobile' ? '80%' : '30%'},on:{\"update:visible\":function($event){_vm.cantBuyVisible=$event}}},[_c('span',[_vm._v(_vm._s(_vm.$t('package.systemError')))]),_c('span',{staticClass:\"dialog-footer\",attrs:{\"slot\":\"footer\"},slot:\"footer\"},[_c('el-button',{attrs:{\"type\":\"primary\"},on:{\"click\":function($event){_vm.cantBuyVisible = false}}},[_vm._v(_vm._s(_vm.$t('common.ok')))])],1)])],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <div :style=\"device === 'mobile' ? {} : {padding: '30px 120px'}\" v-loading=\"payLoading\" :element-loading-text=\"$t('package.payLoadingTip')\">\n    <el-table :data=\"tableData\" border>\n      <el-table-column align=\"left\" prop=\"subject\" :label=\"$t('package.packageInfo')\"></el-table-column>\n      <el-table-column align=\"left\" prop=\"price\" :label=\"$t('package.unitPrice')\"></el-table-column>\n      <el-table-column align=\"left\" prop=\"amount\" :label=\"$t('package.quantity')\"></el-table-column>\n      <el-table-column align=\"left\" prop=\"total\" :label=\"$t('package.expense')\"></el-table-column>\n    </el-table>\n    <div class=\"pay-submit\">\n      <el-card shadow=\"never\">\n        <div>\n          <div class=\"cost\">\n            <span>{{ $t('package.total') }}</span>\n            <span class=\"price\">\n              <span>{{ payMethod === 'alipay' ? '￥' : '$' }}</span>\n              <em>{{ totalPrice }}</em>\n            </span>\n          </div>\n          <el-button type=\"warning\" @click=\"payClick\">{{ $t('package.confirmPurchase') }}</el-button>\n        </div>\n      </el-card>\n    </div>\n    <el-dialog :visible.sync=\"cantBuyVisible\" :width=\"device === 'mobile' ? '80%' : '30%'\">\n      <span>{{ $t('package.systemError') }}</span>\n      <span slot=\"footer\" class=\"dialog-footer\">\n        <el-button type=\"primary\" @click=\"cantBuyVisible = false\">{{ $t('common.ok') }}</el-button>\n      </span>\n    </el-dialog>\n  </div>\n</template>\n\n<script>\nimport { mapGetters } from 'vuex'\nimport { fetchPayUrl } from '@/api/user/package'\n\nexport default {\n  name: 'OrderDetail',\n  data() {\n    return {\n      payLoading: false,\n      cantBuyVisible: false,\n      tableData: [],\n      payMethod: '',\n      totalPrice: 0,\n      orderID: 0\n    }\n  },\n  computed: {\n    ...mapGetters([\n      'device'\n    ])\n  },\n  mounted() {\n    if(this.$route.query.payMethod) {\n      this.formatData()\n    } else {\n      this.$router.push('/user/package')\n    }\n  },\n  methods: {\n    formatData() {\n      this.tableData = [...JSON.parse(this.$route.query.buyData)]\n      console.log(this.tableData)\n      this.tableData.forEach(item => {\n        item.total = item.amount ? (item.amount * item.price).toFixed(2) : item.price.toFixed(2)\n        if(!item.amount) {\n          item.amount = 1\n        }\n      })\n      this.payMethod = this.$route.query.payMethod\n      this.totalPrice = this.$route.query.totalPrice\n      this.orderID = this.$route.query.orderID\n    },\n    payClick() {\n      this.handleFetchPayUrl()\n    },\n    handleFetchPayUrl() {\n      this.payLoading = true\n      fetchPayUrl(this.payMethod, this.orderID, this.device)\n        .then(res => {\n          if(res.data.available) {\n            window.location.href = `${res.data.pay_url}`\n          } else {\n            this.payLoading = false\n            this.cantBuyVisible = true\n          }\n        })\n        .catch(err => {\n          this.payLoading = false\n          console.log(err)\n        })\n    }\n  }\n}\n</script>\n\n<style lang=\"scss\" scoped>\n  .pay-submit {\n    margin-top: 20px;\n    text-align: right;\n  }\n  .cost {\n    display: inline-block;\n    margin-right: 20px;\n    .price {\n      span {\n        vertical-align: top;\n        font-size: 16px;\n        line-height: 20px;\n        margin-right: 5px;\n        color: #ed711f;\n      }\n      em {\n        font-style: normal;\n        font-weight: 400;\n        font-size: 30px;\n        line-height: 30px;\n        color: #ed711f;\n      }\n    }\n    \n  }\n</style>\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./OrderDetail.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./OrderDetail.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./OrderDetail.vue?vue&type=template&id=a31505ce&scoped=true&\"\nimport script from \"./OrderDetail.vue?vue&type=script&lang=js&\"\nexport * from \"./OrderDetail.vue?vue&type=script&lang=js&\"\nimport style0 from \"./OrderDetail.vue?vue&type=style&index=0&id=a31505ce&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"a31505ce\",\n  null\n  \n)\n\ncomponent.options.__file = \"OrderDetail.vue\"\nexport default component.exports","import request from '@/utils/request'\n\n// 获取套餐信息\nexport function fetchPackage() {\n  return request({\n    url: `goods/flow_packet`,\n    method: 'get'\n  })\n}\n\n// 获取包年包月套餐信息\nexport function fetchMonthlyPackage() {\n  return request({\n    url: `goods/monthly_packet`,\n    method: 'get'\n  })\n}\n\n// 用户创建订单\nexport function createOrder(userID, data) {\n  return request({\n    url: `order/user_id/${userID}`,\n    method: 'post',\n    data\n  })\n}\n\n// 获取支付地址\nexport function fetchPayUrl(payMethod, orderID, device) {\n  const param = device === 'mobile' ? '&mobile=true' : ''\n  return request({\n    url: `charge/${payMethod}/pay?order_id=${orderID}${param}`,\n    method: 'get'\n  })\n}\n\n// 检查支付宝支付状态\nexport function checkAlipayOrder(orderID) {\n  return request({\n    url: `charge/alipay/query?order_id=${orderID}`,\n    method: 'get'\n  })\n}\n\n// 检查paypal支付状态\nexport function checkPaypalOrder(orderID, paymentID, payerID) {\n  return request({\n    url: `charge/paypal/query?order_id=${orderID}&payment_id=${paymentID}&payer_id=${payerID}`,\n    method: 'get'\n  })\n}\n\n// 用户签到\nexport function checkIn(userID, data) {\n  return request({\n    url: `user/user_id/${userID}/checkin`,\n    method: 'post',\n    data\n  })\n}"],"sourceRoot":""}